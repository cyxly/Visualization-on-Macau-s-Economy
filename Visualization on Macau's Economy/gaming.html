<!DOCTYPE HTML>
<style>
path {  stroke: #fff; }
path:hover {  opacity:0.9; }
rect:hover {  fill:blue; }
.axis {  font: 20px sans-serif; }
.legend tr{    border-bottom:1px solid grey; }
.legend tr:first-child{    border-top:1px solid grey; }

.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

.x.axis path {  display: none; }
.legend{
	margin-top: 10px;
	margin-left: 50px;
	width: 300px;
    display:inline-block;
    border-collapse: collapse;
    border-spacing: 0px;
}
.legend td{
    padding:4px 5px;
    vertical-align:bottom;
}
.legendFreq, .legendPerc{
    align:right;
    width:50px;
}
#picture_div {
	width: 100px;
	height: 100px;
	margin-left: 200px;
	margin-bottom: 50px;

}

</style>
<html>
	<head>
		<title>Gaming Industry - Spatial by TEMPLATED</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="stylesheet" href="assets/css/main.css" />
	</head>
	<body class="landing">

		<!-- Header -->
			<header id="header" class="alt">
				<nav id="nav">
					<ul>
						<li><a href="index.html">Home</a></li>
						<li><a href="eec.html">Visitor</a></li>
						<li><a href="tourism.html">Tourism</a></li>	
						<li><a href="gaming.html">Gaming industry</a></li>			 		
					</ul>
				</nav>
			</header>

			<a href="#menu" class="navPanelToggle"><span class="fa fa-bars"></span></a>

			<section id="banner" style="background-image: url('./images/overlay.png'), url('./images/banner_gaming.jpeg')">
				<h2>Gaming Industry</h2>
				<div class="container 90%">
				<p>This part is about gaming industry in Macau, we will study the composition of the gaming and find out the main source of revenue in the gaming. We also explore the relationship between visitors and the revenue of the gaming in this part. And the role of Mainland visitors play in the gaming industry.</p>
				</div>
			</section>

		<!-- Main -->
			<section id="main" class="wrapper">
				<div class="container">
					<h2>The Gaming Revenue from 2002-2015.(Million MOP/Year)</h2>
					<div id="picture_div"></div>
					<div id='dashboard'></div>

					<p>We know that gaming industry contribute a lot to Macau’s economy. The tax revenue from gaming accounts for nearly 80% in the public revenue of Macau these years. So it’s important and meaningful for us to study the gaming industry. From this graph, we can see the total revenue of gaming from 2002 to 2015. In the histogram, it’s obviously the revenue increases so rapidly that it grows from 23496 million MOP in 2002 to the climax 361866 million MOP in 2013. It’s nearly 15 times in 2013 than in 2002. So we can see the growth is very obvious. However, in 2014 and 2015, the revenue declines, especially in 2015, the revenue declines more than 120 billion MOP than 2014, the amount is more than 31% of 2014. It’s a big loss to Macau’s economy.</p>

					<p>And the pie chart is composed of different kinds of games in the gaming. There are VIP Baccarat, Baccarat, Slot Machine, Cussec, Blackjack and Lottery Betting. From the char we can see that VIP Baccarat and Baccarat account for more than 90% to the revenue. When you put the mouse on the VIP Baccarat part in the pie chart, you can find that the revenue trend of VIP Baccarat is nearly the same as the total revenue, and it declines nearly 39.8% year-on-year in 2015, and it loss more than 84 billion MOP. So we can conclude that gaming industry is deeply relies on VIP Baccarat.</p>
					<br />
			
					<!-- Text -->

					
					<div class='tableauPlaceholder' id='viz1479382368437' style='position: relative'><noscript><a href='#'><img alt='Dashboard 1 ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Vi&#47;VisitorsGamingRevenue&#47;Dashboard1&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='site_root' value='' /><param name='name' value='VisitorsGamingRevenue&#47;Dashboard1' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Vi&#47;VisitorsGamingRevenue&#47;Dashboard1&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /></object></div>                <script type='text/javascript'>                    var divElement = document.getElementById('viz1479382368437');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='1004px';vizElement.style.height='869px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>

					<p>In this graph, there are four lines including the number of total visitors, visitors from Mainland China and visitors from other places and the gaming revenue. We notice that the trend visitors’ number is growing from 2008 to 2014, only declines in 2009 and 2015. The number of visitors in 2008 is nearly 23 million and more than 31.5 million in 2014. It grows more than 8.5 million in six years. There are still two lines, one is visitors from Mainland China and the other is visitors from other place. We can find that the number of visitors from other place is stable and rarely changes. So the number of tourists is great depends on tourists from Mainland China. Visitors from Mainland account for more than 50% of the total visitors. The trend of total visitors and visitors from Mainland is nearly the same.</p>

					<p>In the gaming revenue line, there is a sharply decline in 2015. It declines about 31% year-on-year, however, the number of visitors only declines 2.57%, about 0.811 million. And we find that the number of visitors from Mainland decreases 0.841 million, it’s even more than the total loss. So the loss of visitors is caused by the decline of visitors from Mainland. And the casinos lose 120 billion MOP because of losing 0.841 million visitors from Mainland. So we can draw the conclusion that visitors from Mainland is very important to the gaming industry.</p>

				
					<header class="major special">
						<h2>Conclusion</h2>
					</header>

					<p>1. VIP Baccarat and Baccarat account for more than 90% revenue of gaming. So the gaming industry relies heavily on Baccarat. The casinos may find some way to divide the capital into other games, after all, it’s too risk to rely on just one game. Once the revenue of Baccarat declines, the gaming industry would suffer a lot.</p>

					<p>2. Visitors from Mainland accounts for more than 50% of the total total visitors. And there is a positive correlation between the gaming revenue the number of visitors. So the trend of visitors from Mainland decides the gaming revenue. Macau should try hard to attract more Mainland visitors.</p>
				</div>
			</section>



			

		<!-- Footer -->
			<footer id="footer">
				<div class="container">
					<a href="#">Back to the Top</a>
				</div>
				<div class="container">
					<!--<ul class="icons">
						<li><a href="#" class="icon fa-facebook"></a></li>
						<li><a href="#" class="icon fa-twitter"></a></li>
						<li><a href="#" class="icon fa-instagram"></a></li>
					</ul>-->
					<ul class="copyright">
						<li>Chen Yixin</li>
						<li>Kang Yangtao</li>
						<li>Li Jinjin</li>
						<li>Ye Yaya</li>
					</ul>
					Data Source : <a href="http://www.dsec.gov.mo/">http://www.dsec.gov.mo</a>
				</div>
			</footer>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/skel.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
			<script src="http://d3js.org/d3.v3.min.js"></script>
			<script>
			function dashboard(id, fData){
			    var barColor = 'steelblue';
			    function segColor(c){ return {vipBaccarat:"#807dba", Baccarat:"#e08214",SlotMachine:"#41ab5d",Cussec:"#04b4ae",Blackjack:"#00FF00",LotteryBetting:"#FF0040"}[c]; }
			    
			    // compute total for each state.
			    fData.forEach(function(d){d.total=d.freq.vipBaccarat+d.freq.Baccarat+d.freq.SlotMachine+d.freq.Cussec+d.freq.Blackjack+d.freq.LotteryBetting;});
			    
			    // function to handle histogram.
			    function histoGram(fD){
			        var hG={},    hGDim = {t: 60, r: 0, b: 30, l: 0};
			        hGDim.w = 900 - hGDim.l - hGDim.r, 
			        hGDim.h = 250 - hGDim.t - hGDim.b;
			            
			        //create svg for histogram.
			        var hGsvg = d3.select(id).append("svg")
			            .attr("width", hGDim.w + hGDim.l + hGDim.r)
			            .attr("height", hGDim.h + hGDim.t + hGDim.b).append("g")
			            .attr("transform", "translate(" + hGDim.l + "," + hGDim.t + ")");

			        // create function for x-axis mapping.
			        var x = d3.scale.ordinal().rangeRoundBands([0, hGDim.w], 0.1)
			                .domain(fD.map(function(d) { return d[0]; }));

			        // Add x-axis to the histogram svg.
			        hGsvg.append("g").attr("class", "x axis")
			            .attr("transform", "translate(0," + hGDim.h + ")")
			            .call(d3.svg.axis().scale(x).orient("bottom"));

			        // Create function for y-axis map.
			        var y = d3.scale.linear().range([hGDim.h, 0])
			                .domain([0, d3.max(fD, function(d) { return d[1]; })]);

			        // Create bars for histogram to contain rectangles and freq labels.
			        var bars = hGsvg.selectAll(".bar").data(fD).enter()
			                .append("g").attr("class", "bar");
			        
			        //create the rectangles.
			        bars.append("rect")
			            .attr("x", function(d) { return x(d[0]); })
			            .attr("y", function(d) { return y(d[1]); })
			            .attr("width", x.rangeBand())
			            .attr("height", function(d) { return hGDim.h - y(d[1]); })
			            .attr('fill',barColor)
			            .on("mouseover",mouseover)// mouseover is defined below.
			            .on("mouseout",mouseout);// mouseout is defined below.
			            
			        //Create the frequency labels above the rectangles.
			        bars.append("text").text(function(d){ return d3.format(",")(d[1])})
			            .attr("x", function(d) { return x(d[0])+x.rangeBand()/2; })
			            .attr("y", function(d) { return y(d[1])-5; })
			            .attr("text-anchor", "middle");
			        
			        function mouseover(d){  // utility function to be called on mouseover.
			            // filter for selected state.
			            var st = fData.filter(function(s){ return s.State == d[0];})[0],
			                nD = d3.keys(st.freq).map(function(s){ return {type:s, freq:st.freq[s]};});
			               
			            // call update functions of pie-chart and legend.    
			            pC.update(nD);
			            leg.update(nD);
			        }
			        
			        function mouseout(d){    // utility function to be called on mouseout.
			            // reset the pie-chart and legend.    
			            pC.update(tF);
			            leg.update(tF);
			        }
			        
			        // create function to update the bars. This will be used by pie-chart.
			        hG.update = function(nD, color){
			            // update the domain of the y-axis map to reflect change in frequencies.
			            y.domain([0, d3.max(nD, function(d) { return d[1]; })]);
			            
			            // Attach the new data to the bars.
			            var bars = hGsvg.selectAll(".bar").data(nD);
			            
			            // transition the height and color of rectangles.
			            bars.select("rect").transition().duration(500)
			                .attr("y", function(d) {return y(d[1]); })
			                .attr("height", function(d) { return hGDim.h - y(d[1]); })
			                .attr("fill", color);

			            // transition the frequency labels location and change value.
			            bars.select("text").transition().duration(500)
			                .text(function(d){ return d3.format(",")(d[1])})
			                .attr("y", function(d) {return y(d[1])-5; });            
			        }        
			        return hG;
			    }
			    
			    // function to handle pieChart.
			    function pieChart(pD){
			        var pC ={},    pieDim ={w:250, h: 250};
			        pieDim.r = Math.min(pieDim.w, pieDim.h) / 2;
			                
			        // create svg for pie chart.
			        var pie_table = d3.select(id).append("div")
			        	.attr("id", "pie_and_table");
			        var piesvg = pie_table.append("svg")
			            .attr("width", pieDim.w).attr("height", pieDim.h).append("g")
			            .attr("transform", "translate("+pieDim.w/2+","+pieDim.h/2+")");
			        
			        // create function to draw the arcs of the pie slices.
			        var arc = d3.svg.arc().outerRadius(pieDim.r - 10).innerRadius(0);

			        // create a function to compute the pie slice angles.
			        var pie = d3.layout.pie().sort(null).value(function(d) { return d.freq; });

			        // Draw the pie slices.
			        piesvg.selectAll("path").data(pie(pD)).enter().append("path").attr("d", arc)
			            .each(function(d) { this._current = d; })
			            .style("fill", function(d) { return segColor(d.data.type); })
			            .on("mouseover",mouseover).on("mouseout",mouseout);

			        // create function to update pie-chart. This will be used by histogram.
			        pC.update = function(nD){
			            piesvg.selectAll("path").data(pie(nD)).transition().duration(500)
			                .attrTween("d", arcTween);
			        }    
					
			        // Utility function to be called on mouseover a pie slice.
			        function mouseover(d){
						// call the update function of histogram with new data.
					    hG.update(fData.map(function(v){ 
			                return [v.State,v.freq[d.data.type]];}),segColor(d.data.type));
							
						// display the image and text
						var div=document.getElementById('picture_div').innerHTML="";
						var svg = d3.select("#picture_div")
							.append("svg")
			                .attr("width", 400)
			                .attr("height", 300);
						var text = svg.selectAll("text")
			                .data([0])
			                .enter()
			                .append("text")
			                .attr("stroke", "#0a0")
							.attr("style", "font-size:24px;")
			                .attr("x", "60")
			                .attr("y", "60");
						var imgs = svg.selectAll("image").data([0]);
			                imgs.enter()
			                .append("svg:image")
			                //.attr("xlink:href", "./pic/SlotMachine.jpg")
			                .attr("x", "60")
			                .attr("y", "60")
			                .attr("width", "200")
			                .attr("height", "200");
						switch(d.data.type){
							case "vipBaccarat":
								text.text("vipBaccarat");
								imgs.attr("xlink:href", "./pic/Baccarat.jpg");
								break;
							case "SlotMachine":
								text.text("SlotMachine");
								imgs.attr("xlink:href", "./pic/SlotMachine.jpg");
								break;
							case "Blackjack":
								text.text("Blackjack");
								imgs.attr("xlink:href", "./pic/Blackjack.jpg");
								break;
							case "Baccarat":
								text.text("Baccarat");
								imgs.attr("xlink:href", "./pic/Baccarat.jpg");
								break;
							case "Cussec":
								text.text("Cussec");
								imgs.attr("xlink:href", "./pic/Cussec.jpg");
								break;
							case "LotteryBetting":
								text.text("LotteryBetting");
								imgs.attr("xlink:href", "./pic/LotteryBetting.jpg");
								break;
						}
					
					
					}
			        //Utility function to be called on mouseout a pie slice.
			        function mouseout(d){
			            // call the update function of histogram with all data.
			            hG.update(fData.map(function(v){
			                return [v.State,v.total];}), barColor);
							
						var div=document.getElementById('picture_div').innerHTML="";
						var svg = d3.select("#picture_div").clear();
			        }
			        // Animating the pie-slice requiring a custom function which specifies
			        // how the intermediate paths should be drawn.
			        function arcTween(a) {
			            var i = d3.interpolate(this._current, a);
			            this._current = i(0);
			            return function(t) { return arc(i(t));    };
			        }    
			        return pC;
			    }
			    
			    // function to handle legend.
			    function legend(lD){
			        var leg = {};
			            
			        // create table for legend.
			        var pie_table = d3.select(pie_and_table);
			        var legend = pie_table.append("table").attr('class','legend');
					
			        // create one row per segment.
			        var tr = legend.append("tbody").selectAll("tr").data(lD).enter().append("tr");
			            
			        // create the first column for each segment.
			        tr.append("td").append("svg").attr("width", '16').attr("height", '16').append("rect")
			            .attr("width", '16').attr("height", '16')
						.attr("fill",function(d){ return segColor(d.type); });
			            
			        // create the second column for each segment.
			        tr.append("td").text(function(d){ return d.type;})
						.attr("style", "font-size:24px;");

			        // create the third column for each segment.
			        tr.append("td").attr("class",'legendFreq')
			            .text(function(d){ return d3.format(",")(d.freq);})
						.attr("style", "font-size:24px;");

			        // create the fourth column for each segment.
			        tr.append("td").attr("class",'legendPerc')
			            .text(function(d){ return getLegend(d,lD);})
						.attr("style", "font-size:24px;");

			        // Utility function to be used to update the legend.
			        leg.update = function(nD){
			            // update the data attached to the row elements.
			            var l = legend.select("tbody").selectAll("tr").data(nD);

			            // update the frequencies.
			            l.select(".legendFreq").text(function(d){ return d3.format(",")(d.freq);});

			            // update the percentage column.
			            l.select(".legendPerc").text(function(d){ return getLegend(d,nD);});        
			        }
			        
			        function getLegend(d,aD){ // Utility function to compute percentage.
			            return d3.format("%")(d.freq/d3.sum(aD.map(function(v){ return v.freq; })));
			        }

			        return leg;
			    }
			    
			    // calculate total frequency by segment for all state.
			    var tF = ['vipBaccarat','Baccarat','SlotMachine', 'Cussec', 'Blackjack', 'LotteryBetting'].map(function(d){ 
			        return {type:d, freq: d3.sum(fData.map(function(t){ return t.freq[d];}))}; 
			    });    
			    
			    // calculate total frequency by state for all segment.
			    var sF = fData.map(function(d){return [d.State,d.total];});

			    var hG = histoGram(sF), // create the histogram.
			        pC = pieChart(tF), // create the pie-chart.
			        leg= legend(tF);  // create the legend.
			}
			</script>

			<script>
			var freqData=[
			{State:'2002',freq:{vipBaccarat:16340, Baccarat:2716, SlotMachine:231, Cussec:641, Blackjack:589, LotteryBetting:1316}}
			,{State:'2003',freq:{vipBaccarat:22178, Baccarat:3102, SlotMachine:236, Cussec:682, Blackjack:637, LotteryBetting:1643}}
			,{State:'2004',freq:{vipBaccarat:29783, Baccarat:5981, SlotMachine:640, Cussec:1212, Blackjack:1211, LotteryBetting:2133}}
			,{State:'2005',freq:{vipBaccarat:28864, Baccarat:10448, SlotMachine:1250, Cussec:1526, Blackjack:1459, LotteryBetting:1087}}
			,{State:'2006',freq:{vipBaccarat:36783, Baccarat:11911, SlotMachine:2053, Cussec:1923, Blackjack:1622, LotteryBetting:898}}
			,{State:'2007',freq:{vipBaccarat:55762, Baccarat:16515, SlotMachine:3594, Cussec:2755, Blackjack:1917, LotteryBetting:825}}
			,{State:'2008',freq:{vipBaccarat:73772, Baccarat:21264, SlotMachine:5653, Cussec:3043, Blackjack:2247, LotteryBetting:1054}}
			,{State:'2009',freq:{vipBaccarat:79834, Baccarat:25498, SlotMachine:6503, Cussec:2826, Blackjack:1903, LotteryBetting:1014}}
			,{State:'2010',freq:{vipBaccarat:135648, Baccarat:34917, SlotMachine:8618, Cussec:3555, Blackjack:2290, LotteryBetting:1245}}
			,{State:'2011',freq:{vipBaccarat:196126, Baccarat:48669, SlotMachine:11425, Cussec:4774, Blackjack:2712, LotteryBetting:1192}}
			,{State:'2012',freq:{vipBaccarat:210850, Baccarat:66251, SlotMachine:13244, Cussec:5546, Blackjack:2950, LotteryBetting:1096}}
			,{State:'2013',freq:{vipBaccarat:238524, Baccarat:91599, SlotMachine:14384, Cussec:6756, Blackjack:3052, LotteryBetting:1118}}
			,{State:'2014',freq:{vipBaccarat:212535, Baccarat:106527, SlotMachine:14444, Cussec:7583, Blackjack:2933, LotteryBetting:1193}}
			,{State:'2015',freq:{vipBaccarat:127818, Baccarat:76212, SlotMachine:11754, Cussec:6347, Blackjack:2352, LotteryBetting:971}}
			];

			dashboard('#dashboard',freqData);

			</script>

	</body>
</html>